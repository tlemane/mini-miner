include(ExternalProject)

set(THIRDPARTY_SRC_DIR "${PROJECT_SOURCE_DIR}/thirdparty")
set(THIRDPARTY_BUILD_DIR "${PROJECT_BINARY_DIR}/thirdparty")

# googletest
ExternalProject_Add(GTEST
  PREFIX GTEST
  SOURCE_DIR ${PROJECT_SOURCE_DIR}/thirdparty/googletest
  INSTALL_COMMAND ""
)
set(GTEST_DIR "${THIRDPARTY_SRC_DIR}/googletest")
set(GTEST_INCLUDE "${GTEST_DIR}/googletest/include")
set(GTEST_LIB "${THIRDPARTY_BUILD_DIR}/GTEST/src/GTEST-build/lib")
get_sha1(${GTEST_DIR} GTEST_SHA1)
set(GTEST_SHA1 ${GTEST_SHA1} PARENT_SCOPE)

# spdlog
ExternalProject_Add(SPDLOG
  PREFIX SPDLOG
  SOURCE_DIR ${PROJECT_SOURCE_DIR}/thirdparty/spdlog
  INSTALL_COMMAND ""
)
set(SPDLOG_DIR "${THIRDPARTY_SRC_DIR}/spdlog")
set(SPDLOG_INCLUDE "${SPDLOG_DIR}/include")
set(SPDLOG_LIB "${THIRDPARTY_BUILD_DIR}/SPDLOG/src/SPDLOG-build/lib")
get_sha1(${SPDLOG_DIR} SPDLOG_SHA1)
set(SPDLOG_SHA1 ${SPDLOG_SHA1} PARENT_SCOPE)

# bcli
set(BCLI_DIR "${THIRDPARTY_SRC_DIR}/bcli")
set(BCLI_INCLUDE "${BCLI_DIR}/include")

# robin hood
set(ROBIN_DIR "${THIRDPARTY_SRC_DIR}/robin-hood-hashing")
set(ROBIN_INCLUDE "${ROBIN_DIR}/src/include")

# kmercpp
set(KMERCPP_DIR "${THIRDPARTY_SRC_DIR}/kmercpp")
set(KMERCPP_INCLUDE "${KMERCPP_DIR}/include")

# kseqpp
ExternalProject_Add(KSEQPP
  PREFIX KSEQPP
  SOURCE_DIR ${THIRDPARTY_SRC_DIR}/kseqpp
  INSTALL_COMMAND ""
)
set(KSEQPP_DIR "${THIRDPARTY_SRC_DIR}/kseqpp")
set(KSEQPP_INCLUDE "${KSEQPP_DIR}/include")

# hyerloglog
set(HYPER_DIR "${THIRDPARTY_SRC_DIR}/cpp-HyperLogLog")
set(HYPER_INCLUDE ${HYPER_DIR}/include)

# set dependencies for targets
set(APP_DEPENDENCIES "SPDLOG" "KSEQPP" PARENT_SCOPE)
set(LIB_DEPENDENCIES "SPDLOG" "KSEQPP" PARENT_SCOPE)
set(TESTS_DEPENDENCIES "GTEST" PARENT_SCOPE)

set(LIB_INCLUDE_DIR "${SPDLOG_INCLUDE}" "${KSEQPP_INCLUDE}" "${HYPER_INCLUDE}" PARENT_SCOPE)
set(APP_INCLUDE_DIR "${SPDLOG_INCLUDE}" "${BCLI_INCLUDE}" "${KMERCPP_INCLUDE}" "${KSEQPP_INCLUDE}" "${HYPER_INCLUDE}" PARENT_SCOPE)
set(APP_LINK_DIR "" PARENT_SCOPE)
set(APP_LINK "" PARENT_SCOPE)
set(TEST_INCLUDE_DIR "${GTEST_INCLUDE}" PARENT_SCOPE)
set(TEST_LINK_DIR "${GTEST_LIB}" PARENT_SCOPE)
set(TEST_LINK gtest gtest_main PARENT_SCOPE)

set(THIRDPARTY_INCLUDE
    ${SPDLOG_INCLUDE})

include_directories(${THIRDPARTY_INCLUDE})